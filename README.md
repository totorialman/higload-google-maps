# Google Maps 

## 1. Тема и целевая аудитория
**Google Maps** — сервис Google для просмотра карт, спутниковых снимков, панорам улиц и построения маршрутов в реальном времени.

### Функционал MVP
- Просмотр карты  
- Построение маршрутов  
- Поиск мест и организаций  
- Просмотр информации о местах  
- Загрузка офлайн-карт  

### Целевая аудитория
MAU: **2 млрд пользователей**[^1]

| Страна   | Доля[^2] | Пользователей в месяц |
|----------|------|------------------------|
| США      | 11,32 % | 226 млн |
| Турция   | 8,77 %  | 175 млн |
| Япония   | 8,24 %  | 165 млн |
| Индия    | 6,64 %  | 133 млн |
| Бразилия | 6,14 %  | 123 млн |
| Остальные| 58,89 % | 1178 млн |

---

## 2. Расчет нагрузки
### Продуктовые метрики

| Метрика | Значение |
|---------|----------|
| MAU[^1] | 2 млрд |  
| DAU[^3] (stickiness 30%) | 600 млн |  
| Среднее число запусков приложения в месяц[^3] | 50 |  
| Среднее число сессий в день (расчёт) | 1,67 | расчёт 
| Количество мест в базе[^1] | 250 млн |  

---

### Среднее количество действий одного пользователя в день

| Действие                        | Повторений в день | Обоснование |
|---------------------------------|-------------------|-------------|
| Отображение карты               | 2,0               | В среднем 50 запусков в месяц ≈ 1,67 в день, округлено до 2 с учётом повторных загрузок |
| Отображение информации о местах | 3,3               | В среднем 2 запроса на сессию при 1,67 сессии в день |
| Поиск мест и организаций        | 2,4               | 71% сессий включают поиск[^4], по 2 запроса: 1,67 × 0,71 × 2 ≈ 2,4 |
| Построение маршрутов            | 1,3               | 75% сессий включают построение маршрута[^4]: 1,67 × 0,75 ≈ 1,3 |
| Загрузка оффлайн-карт           | 0,02              | Загрузка/обновление ≈ 1 раз в 2 месяца |

---

### Технические метрики

#### Хранилище

## Информация о местах

В базе ~250 млн объектов[^1]. Основные поля и предполагаемый размер записи:

| Поле                     | Описание                      | Средний объем на 1 объект |
| ------------------------ | ----------------------------- | ------------------------- |
| **ID места**             | Уникальный идентификатор      | 16 байт                   |
| **Название**             | Текст (UTF-8)                 | 50 байт                   |
| **Категория**            | Тип места (кафе, отель, парк) | 16 байт                   |
| **Координаты (lat/lon)** | Два float-числа               | 16 байт                   |
| **Часы работы**          | JSON-объект                   | 200 байт                  |
| **Отзывы**               | Список текстовых данных       | ~1 КБ (по 10 отзывов)     |
| **Рейтинг**              | Число с плавающей точкой      | 8 байт                    |
| **Доп. данные**          | Телефон, сайт, соцсети        | 200 байт                  |

Согласно официальному Places API[^7], есть ещё много дополнительных полей (например, типы мест, метки, варианты парковки и тд), поэтому **округляю средний размер объекта до 3 КБ**.  

- Информация о местах: 250 млн × 3 КБ ≈ **720 ГБ**  
- Размер кэша тайлов (по данным OSM): **1250 ГБ**[^5]  

**Итоговое хранилище ≈ 2 ТБ.**

---

### RPS по типам запросов

**DAU = 600 млн.**  
**Среднее время суток = 86 400 секунд.**  
Пиковая нагрузка = 3× среднего значения.

Отображение карты: 2,0 (действий в сутки) / 86400 (секунд в сутках) * 600M DAU ≈ 13.9K

| Тип запроса                | Действий/день | Средний RPS     | Пиковый RPS (×3) |
|----------------------------|---------------|------------------|------------------|
| Отображение карты          | 2,0           | 13,9K            | **41,7K**        |
| Информация о местах        | 3,3           | 23,2K            | **69,6K**        |
| Поиск мест                 | 2,4           | 16,5K            | **49,5K**        |
| Построение маршрутов       | 1,3           | 9,0K             | **27,0K**        |
| Загрузка оффлайн-карт      | 0,02          | 139              | **417**          |
---

### Сетевой трафик

| Тип запроса                | Размер 1 запроса | Средний RPS | Пиковый RPS | Пиковый трафик |
|-----------------------------|------------------|-------------|-------------|----------------|
| Отображение карты           | 7,2 КБ (~12 тайлов за раз при 1080p при 16 уровне масштабирования) | 13,9K | 27,8K | **~2,4 Гбит/с**  |
| Информация о местах         | 3 КБ             | 23,2K | 46,4K | **~1,67 Гбит/с**   |
| Поиск мест                  | 1 КБ (10 результатов)            | 16,5K | 33K   | **~0,4 Гбит/с**   |
| Построение маршрутов        | 5,2 КБ (Маршрут ~10 км: ~200 точек × 16 Б = 3,2 КБ + метаданные (~2 КБ) → ≈ 5,2 КБ)          | 9,0K  | 18,0K | **~1,12 Гбит/с** |
| Загрузка оффлайн-карт       | 10 МБ (≈ 17 000 тайлов уровня 16, один тайл ≈ 0,12 км², общая площадь ≈ 2 048 км²)            | 139   | 278   | **~33,4 Мбит/с**  |

**Площадь одного тайла на уровне 16**  

- На уровне 16 весь земной шар делится на 2^16 * 2^16 = 65,536 * 65,536 тайлов.  
- Земная поверхность ≈ 510 млн км².  
- Площадь одного тайла:  ≈ 0,12 км² 

**Общая площадь оффлайн-карты**  

- Количество тайлов: 17 067  
- Общая площадь: 17 067 × 0,12 км² ≈ 2 048 км²
---

## Источники
[^1]: [Почему Google?](https://mapsplatform.google.com/why-google/)  
[^2]: [Анализ веб-трафика Google Maps](https://pro.similarweb.com/#/digitalsuite/websiteanalysis/audience-geography/*/999/3m?key=maps.google.com&webSource=Total)  
[^3]: [Статистика и тренды Google Maps](https://www.loopexdigital.com/blog/google-maps-statistics)  
[^4]: [Как часто россияне используют геосервисы](https://iom.anketolog.ru/2020/02/12/geoservisy)  
[^5]: [Размер тайлов и кэша OSM](https://switch2osm.org/serving-tiles/plan/)  
[^6]: [Google Maps Statistics 2024](https://www.onthemap.com/blog/google-maps-statistics/)  
[^7]: [API](https://developers.google.com/maps/documentation/places/web-service/data-fields)
